<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CoStudent</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>


    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="wrapper">
        <div id="headerwrap">
            <div id="header">
                <h1>CoStudent</h1>
            </div>
        </div>
        <div id="leftcolumnwrap">
            <div id="leftcolumn">
                <button onclick="ChatToggle('chat1')">Læringsteknologi</button>
                <button onclick="ChatToggle('chat2')">HW & Robotteknologi</button>
                <button onclick="ChatToggle('chat3')">Web Programmering</button>
                <button onclick="ChatToggle('chat4')">3D Programmering</button>
            </div>
        </div>
        <div id="contentwrap">
            <div id="content">
                <form class="chat" id="chat1">
                    <h1>Læringsteknologi</h1>
                    <div class="messages" id="msgScroll">
                    </div>
                    <div class="chatInputs">
                        <button type="submit">Send</button>
                        <input type="text" name="message" placeholder="Message">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                </form>
                <form class="chat" id="chat2">
                    <h1>HW & Robotteknologi</h1>
                    <div class="messages"></div>
                    <div class="chatInputs">
                        <button type="submit">Send</button>
                        <input type="text" name="message" placeholder="Message">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                </form>
                <form class="chat" id="chat3">
                    <h1>Web Programmering</h1>
                    <div class="messages"></div>
                    <div class="chatInputs">
                        <button type="submit">Send</button>
                        <input type="text" name="message" placeholder="Message">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                </form>
                <form class="chat" id="chat4">
                    <h1>3D Programmering</h1>
                    <div class="messages"></div>
                    <div class="chatInputs">
                        <button type="submit">Send</button>
                        <input type="text" name="message" placeholder="Message">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                </form>
            </div>
        </div>
        <div id="rightcolumnwrap">
            <div id="rightcolumn">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed
                    cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum.
                    Praesent mauris. Fusce nec tellus sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget
                    nulla.</p>
            </div>
        </div>
    </div>
    <script>
        var socket = io('http://localhost:3000');

        ChatManager('#chat1');
        ChatManager('#chat2');
        ChatManager('#chat3');
        ChatManager('#chat4');

        function ChatManager(chatId) {
            function renderMessage(message) {
                $(chatId).children('.messages').append('<div id = "message"><strong>' + message.user +
                    '</strong>: <p>' + message.message + '</div>');
            };

            socket.on(`receivedMessage${chatId}`, data => {
                renderMessage(data);
            });

            socket.on(`previousMessages${chatId}`, function (messages) {
                for (message of messages) {
                    renderMessage(message);
                }
            });

            $(chatId).submit(function (event) {
                event.preventDefault();

                var user = $('input[name=username]').val();
                var message = $('input[name=message]').val();

                if (user.length && message.length) {
                    var messageObject = {
                        user: user,
                        message: message
                    };

                    renderMessage(messageObject);
                    socket.emit(`sendMessage${chatId}`, messageObject);
                    console.log("Message sent!")

                    $('input[name=username]').val("");
                    $('input[name=message]').val("");
                }
            });
        }

        function ChatToggle(chatId) {
            if (chatId == 'chat1') {
                document.getElementById('chat1').style.visibility = "visible";
                document.getElementById('chat2').style.visibility = "hidden";
                document.getElementById('chat3').style.visibility = "hidden";
                document.getElementById('chat4').style.visibility = "hidden";
                console.log("Toggled læringsteknologi")
            }

            if (chatId == 'chat2') {
                document.getElementById('chat1').style.visibility = "hidden";
                document.getElementById('chat2').style.visibility = "visible";
                document.getElementById('chat3').style.visibility = "hidden";
                document.getElementById('chat4').style.visibility = "hidden";
                console.log("Toggled hw-&-robotteknologi")
            }

            if (chatId == 'chat3') {
                document.getElementById('chat1').style.visibility = "hidden";
                document.getElementById('chat2').style.visibility = "hidden";
                document.getElementById('chat3').style.visibility = "visible";
                document.getElementById('chat4').style.visibility = "hidden";
                console.log("Toggle web-programmering")
            }

            if (chatId == 'chat4') {
                document.getElementById('chat1').style.visibility = "hidden";
                document.getElementById('chat2').style.visibility = "hidden";
                document.getElementById('chat3').style.visibility = "hidden";
                document.getElementById('chat4').style.visibility = "visible";
                console.log("Toggle 3d-programmering")
            }
        }
    </script>
</body>

</html>

</html>